<!--
Copyright 2024 Marcel Domke

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->


<!-- Node Definition -->
<script type="text/javascript">
    RED.nodes.registerType('reolink-siren', {
        category: 'Reolink',
        color: '#ff5454',
        defaults: {
            name: { value: "" },
            server: { value: "", type: "reolink-device", required: true }
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-bell",
        label: function () {
            return this.name || "Reolink Siren";
        },
        paletteLabel: function () {
            return "Siren";
        }
    });
</script>

<!-- Edit Template -->
<script type="text/html" data-template-name="reolink-siren">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Node name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-wrench"></i> Device</label>
        <select id="node-input-server"></select>
    </div>
</script>

<!-- Help Text -->
<script type="text/html" data-help-name="reolink-siren">
    <p>The <b>Reolink Siren</b> node allows you to control and monitor the state of the audio alarm (siren) on a Reolink device. The siren will sound when motion is detected.</p>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload</dt>
        <dd>A boolean value to control the state of the audio alarm:</dd>
        <ul>
            <li><code>true</code>: Turns the audio alarm ON.</li>
            <li><code>false</code>: Turns the audio alarm OFF.</li>
        </ul>
    </dl>
    <p>When an input message with a boolean payload (true or false) is received, the node sends the corresponding command to the Reolink device to turn the audio alarm ON or OFF.</p>

    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload</dt>
        <dd>A boolean value indicating the state of the audio alarm:</dd>
        <ul>
            <li><code>true</code>: The audio alarm is ON.</li>
            <li><code>false</code>: The audio alarm is OFF.</li>
        </ul>
    </dl>
    <p>The node periodically queries the Reolink device for the current state of the audio alarm. If the state changes, it emits the updated state (true for ON, false for OFF) as the message payload.</p>
</script>
